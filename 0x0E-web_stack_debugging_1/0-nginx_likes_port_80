#!/bin/bash

# Check if Nginx is installed
if ! command -v nginx &> /dev/null; then
	echo "Nginx is not installed. Installing..."
	apt-get update
	apt-get install -y nginx
fi

# Check if Nginx is running
if ! service nginx status &> /dev/null; then
	echo "Nginx is not running. Starting..."
	service nginx start
fi

# Check Nginx configuration
if ! nginx -t &> /dev/null; then
	echo "Nginx configuration test failed. Exiting."
	exit 1
fi

# Check if any other service is using port 80
if sudo netstat -tuln | grep ':80'; then
	echo "Another service is using port 80. Exiting."
	exit 1
fi

# Restart Nginx
service nginx restart

echo "Nginx is configured and listening on port 80."
